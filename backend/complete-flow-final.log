ğŸ”‘ OpenRouter API Key loaded: YES
ğŸ“‹ [LLM MODELS] Configured: {
  openai: 'openai/gpt-4o',
  gemini: 'google/gemini-2.5-flash',
  claude: 'anthropic/claude-3.5-sonnet',
  perplexity: 'perplexity/sonar-pro'
}
ğŸ§ª PromptTestingService initialized (deterministic scoring)
ğŸ“Š MetricsAggregationService initialized

================================================================================
ğŸš€ COMPLETE BACKEND FLOW TEST - NEW METRICS SYSTEM
================================================================================

âœ… Connected to MongoDB

ğŸ“‹ SETUP: Test User

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ… Using test user: satyajeetdas225@gmail.com
ğŸ§¹ Cleaning up old test data...
âœ… Cleanup complete

User ID: 68e7ef58da34c5124ad5fb1c

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Š STEP 1: URL ANALYSIS

================================================================================

Analyzing: https://stripe.com
Using: Perplexity AI (perplexity/sonar-pro)

ğŸ” Starting website analysis for: https://stripe.com
ğŸ“„ Scraping website: https://stripe.com
âŒ Scraping failed: page.waitForTimeout is not a function
ğŸ”„ Attempting fallback scraping method...
âœ… Fallback scraping successful
ğŸ¤– Starting AI analysis...
âœ… Successfully parsed competitors analysis
   Raw data keys: competitors
   Normalized keys: competitors
   Competitors count: 6
âœ… Successfully parsed brandContext analysis
   Raw data keys: companyName, industry, businessModel, targetMarket, valueProposition, keyServices, brandTone, marketPosition
   Normalized keys: companyName, industry, businessModel, targetMarket, valueProposition, keyServices, brandTone, marketPosition
âœ… Successfully parsed personas analysis
   Raw data keys: personas
   Normalized keys: personas
   Personas count: 4
âœ… Successfully parsed topics analysis
   Raw data keys: topics
   Normalized keys: topics
   Topics count: 8
âœ… Website analysis completed successfully
âœ… Analysis Complete!

âœ… Saved UrlAnalysis to database
âœ… Saved 6 competitors
âœ… Saved 8 topics
âœ… Saved 4 personas

ğŸ“Š Analysis Summary:
Brand: Stripe
Description: undefined...
Competitors: 6
Topics: 8
Personas: 4

Analysis ID: 68e8e309d29b778ba0039972

â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

ğŸ“Š STEP 2: USER SELECTIONS

================================================================================

Found 3 competitors to select
âœ… Selected competitor: PayPal
âœ… Selected competitor: Square
âœ… Selected competitor: 2Checkout (Verifone)
Found 2 topics to select
âœ… Selected topic: Global Payment Processing
âœ… Selected topic: Revenue and Finance Automation
Found 2 personas to select
âœ… Selected persona: Startup Founder / Small Business Owner
âœ… Selected persona: Developer / Technical Lead

â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€
â”€

ğŸ“Š STEP 3: PROMPT GENERATION

================================================================================

Generating prompts for 2 topics Ã— 2 personas = 4 combinations...

ğŸ¯ Starting prompt generation...
Topics: 2, Personas: 2
Generating prompts for: Global Payment Processing Ã— Startup Founder / Small Business Owner
ğŸ” Topic object: {
  id: '68e8e309d29b778ba0039992',
  _id: new ObjectId('68e8e309d29b778ba0039992'),
  name: 'Global Payment Processing'
}
ğŸ” Persona object: {
  id: '68e8e309d29b778ba00399a2',
  _id: new ObjectId('68e8e309d29b778ba00399a2'),
  type: 'Startup Founder / Small Business Owner'
}
ğŸ” Prompt generation context for Global Payment Processing Ã— Startup Founder / Small Business Owner:
   Brand: Stripe
   URL: https://stripe.com
ğŸ” Generated prompts for topic-persona combination: {
  topicId: new ObjectId('68e8e309d29b778ba0039992'),
  topicName: 'Global Payment Processing',
  personaId: new ObjectId('68e8e309d29b778ba00399a2'),
  personaType: 'Startup Founder / Small Business Owner',
  promptCount: 5
}
Generating prompts for: Global Payment Processing Ã— Developer / Technical Lead
ğŸ” Topic object: {
  id: '68e8e309d29b778ba0039992',
  _id: new ObjectId('68e8e309d29b778ba0039992'),
  name: 'Global Payment Processing'
}
ğŸ” Persona object: {
  id: '68e8e309d29b778ba00399a3',
  _id: new ObjectId('68e8e309d29b778ba00399a3'),
  type: 'Developer / Technical Lead'
}
ğŸ” Prompt generation context for Global Payment Processing Ã— Developer / Technical Lead:
   Brand: Stripe
   URL: https://stripe.com
ğŸ” Generated prompts for topic-persona combination: {
  topicId: new ObjectId('68e8e309d29b778ba0039992'),
  topicName: 'Global Payment Processing',
  personaId: new ObjectId('68e8e309d29b778ba00399a3'),
  personaType: 'Developer / Technical Lead',
  promptCount: 5
}
Generating prompts for: Revenue and Finance Automation Ã— Startup Founder / Small Business Owner
ğŸ” Topic object: {
  id: '68e8e309d29b778ba0039993',
  _id: new ObjectId('68e8e309d29b778ba0039993'),
  name: 'Revenue and Finance Automation'
}
ğŸ” Persona object: {
  id: '68e8e309d29b778ba00399a2',
  _id: new ObjectId('68e8e309d29b778ba00399a2'),
  type: 'Startup Founder / Small Business Owner'
}
ğŸ” Prompt generation context for Revenue and Finance Automation Ã— Startup Founder / Small Business Owner:
   Brand: Stripe
   URL: https://stripe.com
ğŸ” Generated prompts for topic-persona combination: {
  topicId: new ObjectId('68e8e309d29b778ba0039993'),
  topicName: 'Revenue and Finance Automation',
  personaId: new ObjectId('68e8e309d29b778ba00399a2'),
  personaType: 'Startup Founder / Small Business Owner',
  promptCount: 5
}
Generating prompts for: Revenue and Finance Automation Ã— Developer / Technical Lead
ğŸ” Topic object: {
  id: '68e8e309d29b778ba0039993',
  _id: new ObjectId('68e8e309d29b778ba0039993'),
  name: 'Revenue and Finance Automation'
}
ğŸ” Persona object: {
  id: '68e8e309d29b778ba00399a3',
  _id: new ObjectId('68e8e309d29b778ba00399a3'),
  type: 'Developer / Technical Lead'
}
ğŸ” Prompt generation context for Revenue and Finance Automation Ã— Developer / Technical Lead:
   Brand: Stripe
   URL: https://stripe.com
ğŸ” Generated prompts for topic-persona combination: {
  topicId: new ObjectId('68e8e309d29b778ba0039993'),
  topicName: 'Revenue and Finance Automation',
  personaId: new ObjectId('68e8e309d29b778ba00399a3'),
  personaType: 'Developer / Technical Lead',
  promptCount: 5
}
âœ… Generated 20 prompts successfully
âœ… Generated 20 prompts


âŒ ERROR: Prompt validation failed: title: Path `title` is required., text: Path `text` is required.
ValidationError: Prompt validation failed: title: Path `title` is required., text: Path `text` is required.
    at Document.invalidate (/home/jeet/rankly/tryrankly/backend/node_modules/mongoose/lib/document.js:3362:32)
    at /home/jeet/rankly/tryrankly/backend/node_modules/mongoose/lib/document.js:3123:17
    at /home/jeet/rankly/tryrankly/backend/node_modules/mongoose/lib/schemaType.js:1417:9
    at process.processTicksAndRejections (node:internal/process/task_queues:85:11)
Disconnected from MongoDB
